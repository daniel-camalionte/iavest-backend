name: Deploy STG

on:
  push:
    branches:
      - stg

jobs:
  deploy:
    runs-on: ubuntu-latest
    environment: stg

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 2

      - name: Install lftp
        run: sudo apt-get install -y lftp

      - name: Upload via FTP
        run: |
          lftp -e "
            set ftp:ssl-allow no;
            set net:timeout 30;
            open -u '${{ secrets.FTP_USER }}','${{ secrets.FTP_PASSWORD }}' ${{ secrets.FTP_HOST }};
            cd /;
            pwd;
            ls;
            cd apps_wsgi;
            pwd;
            cd stg;
            pwd;
            quit
          "
